---
title: "Infrastructure as Code (IaC) for MLOps with Terraform & ZenML"
slug: "mlops-terraform-zenml"
draft: false
webflow:
  siteId: "64a817a2e7e2208272d1ce30"
  itemId: "66a906ccbb7bcbf9fb0058bc"
  exportedAt: "2026-02-11T10:23:34.071Z"
  source: "live"
  lastPublished: "2024-08-20T07:31:46.871Z"
  lastUpdated: "2024-08-20T07:31:45.962Z"
  createdOn: "2024-07-30T15:29:16.655Z"
author: "zenml-team"
category: "zenml-updates"
tags:
  - "stacks"
  - "aws"
  - "gcp"
  - "azure"
date: "2024-07-31T00:00:00.000Z"
readingTime: 6 min
mainImage:
  url: "https://pub-d0f853843b954aadbcd60eaff1d9c6e2.r2.dev/webflow/64a817a2e7e2208272d1ce30/dc1bc81a/66a90449c8b4472cfb2383c6_zenml-terraform-min.png"
seo:
  title: "Infrastructure as Code (IaC) for MLOps with Terraform & ZenML - ZenML Blog"
  description: "Infrastructure-as-code meets MLOps: Terraform modules for deploying ML infrastructure on AWS, GCP, and Azure on the Hashicorp registry."
  canonical: "https://www.zenml.io/blog/mlops-terraform-zenml"
  ogImage: "https://pub-d0f853843b954aadbcd60eaff1d9c6e2.r2.dev/webflow/64a817a2e7e2208272d1ce30/a8f655df/66a90449c8b4472cfb2383c6_zenml-terraform-min.png"
  ogTitle: "Infrastructure as Code (IaC) for MLOps with Terraform & ZenML - ZenML Blog"
  ogDescription: "Infrastructure-as-code meets MLOps: Terraform modules for deploying ML infrastructure on AWS, GCP, and Azure on the Hashicorp registry."
---

# üßë‚Äçüíª What is Infrastructure-as-code?

[Infrastructure-as-code (IaC) ](https://aws.amazon.com/what-is/iac/#:~:text=Infrastructure%20as%20code%20(IaC)%20is,%2C%20database%20connections%2C%20and%20storage.)refers to using a dynamic codebase to provision and manage infrastructure, rather than deferring to manual processes. Before IaC took over as a mainstay in the DevOps world, there was no one standard for automating the management of infrastructure resources, especially using the hyperscalers like AWS, GCP, and Azure.

## Popular tools for IaC

By now, there are many tools in the IaC space, however, these are a few that remain the most widely used:

<ul id=""><li id=""><a href="https://www.terraform.io/" target="_blank" id="">Terraform</a><strong id="">:</strong> Arguably, the tool that popularized IaC. It remains one of the standards in the space and has its configuration language called <a href="https://developer.hashicorp.com/terraform/language/syntax/configuration" target="_blank" id="">HCL</a>.</li><li id=""><a href="https://www.pulumi.com/" target="_blank" id="">Pulumi</a>: A competitor to Terraform, with the key difference being that it can be used in any programming language, not just HCL.</li><li id=""><a href="https://aws.amazon.com/cloudformation/" target="_blank" id="">AWS CloudFormation</a>, <a href="https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/overview" target="_blank" id="">Azure Resource Manager</a>, and <a href="https://cloud.google.com/deployment-manager/docs" target="_blank" id="">Google Cloud Deployment Manager</a>: ****These are services offered by cloud providers, with their own syntax and methodologies. They offer the advantage of being native to the underlying cloud provider, but come with the disadvantage of your code usually then being constrained to only that cloud provider.</li></ul>

For this blog post, I will be focusing on Terraform as it is by far the most popular tool. However, ZenML does have a [1-click deployment feature in the browser](https://www.zenml.io/blog/easy-mlops-pipelines) that leverages native cloud services like AWS CloudFormation.

# ü•ò Infrastructure as Code in MLOps

In many ways, [MLOps is an extension of DevOps](https://farisology.medium.com/zenml-the-ultimate-open-source-framework-for-mlops-9e64900f16ec), and therefore it is only natural that IaC plays as critical a role in MLOps, as it does in DevOps. Just like with any other computing paradigm, MLOps also requires users to provision and manage resources on the cloud. Therefore, ML practitioners can simply reuse the tried and tested practices of IaC in DevOps, and reap the same rewards. Specifically, for machine learning teams, adopting IaC can lead to the following benefits:

<ul id=""><li id="">Consistent and reproducible rollouts of experiments, training, and deployments</li><li id="">A strong security standard for machine learning</li><li id="">Visibility into spending and potential for cost optimization</li><li id="">A link between ML and the rest of the organization's infrastructure deployments</li><li id="">Easy onboarding of new teams/projects</li></ul>

# üì¶MLOps Stacks: Modularized configuration for your infrastructure

[ZenML](https://github.com/zenml-io/zenml) is a MLOps framework that acts as a bridge between machine learning teams and production infrastructure. The ZenML stack concept is the configuration of tools and infrastructure that your pipelines can run on. ¬†[A machine learning pipeline written in ZenML](https://docs.zenml.io/user-guide/starter-guide/create-an-ml-pipeline) runs on the configuration defined in the stack.

<figure>
  <img src="https://pub-d0f853843b954aadbcd60eaff1d9c6e2.r2.dev/webflow/64a817a2e7e2208272d1ce30/80d7db0d/66a906ccbb7bcbf9fb0058ac_66a9050f57aabfe2cc7168cc_pipeline_production-min.png" alt="A visualization of a machine learning pipeline loading production data on the left side, and a showcase of a ZenML stack on the right side. The stack consists of a Kubernetes orchestrator, an S3 artifact store, an MLflow experiment tracker, and a deepchecks data validator." />
</figure>

Out of the box, ZenML‚Äôs API assumes that the infrastructure is already provisioned and then expects to register the components in its database. This can be a bit clunky, as it involves enabling the right permissions, executing the correct commands, and ensuring things work as expected across environments. All in all, it can be cumbersome to try to automate this process!

However, if you look closely, there is a natural link between the infrastructure deployed via IaC and the ZenML stack. ¬†What if there is a way to do the provisioning and registration back to ZenML in one go? This is where the Terraform modules for ZenML stacks come in.

# üõ´ Terraform Modules for ZenML Stacks

<figure id="" class="w-richtext-figure-type-video w-richtext-align-fullwidth" style="padding-bottom:56.206088992974244%" data-rt-type="video" data-rt-align="fullwidth" data-rt-max-width="" data-rt-max-height="56.206088992974244%" data-rt-dimensions="854:480" data-page-url="https://www.youtube.com/watch?v=AU2MeBDG3D4"><div id=""><iframe allowfullscreen="true" frameborder="0" scrolling="no" src="https://www.youtube.com/embed/AU2MeBDG3D4" title="Easier MLOps Stacks 3: Infrastructure-as-Code with ZenML Terraform Modules for AWS, GCP, and Azure"></iframe></div></figure>

Recently, we published [new modules to the Hashicorp registry](https://registry.terraform.io/modules/zenml-io/zenml-stack) for provisioning a MLOps stack on each of the popular cloud providers. These Terraform modules set up the necessary infrastructure for a [ZenML](https://zenml.io/) stack and register the necessary configuration back to a ZenML server. This allows you to easily integrate MLOps into your existing cloud infrastructure without any reinventing of the wheel!

Here is how to do it:

## üõ† Prerequisites

<ul id=""><li id="">Terraform installed (version &gt;= 1.9")</li><li id=""><a href="https://aws.amazon.com/account/" target="_blank" id="">AWS</a>, <a href="https://cloud.google.com/resource-manager/docs/creating-managing-projects" target="_blank" id="">GCP</a>, or <a href="https://azure.microsoft.com/en-us/free/search" target="_blank" id="">Azure</a> account set up</li><li id=""><a href="https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html" target="_blank" id="">AWS</a>, <a href="https://cloud.google.com/sdk/gcloud" target="_blank" id="">GCP</a>, or <a href="https://learn.microsoft.com/en-us/cli/azure/install-azure-cli" target="_blank" id="">Azure</a> CLI installed and authenticated</li><li id=""><a href="https://docs.zenml.io/getting-started/installation" id="">ZenML (version &gt;= 0.62.0) installed and configured</a>. You'll need a ZenML server deployed in a remote setting where it can be accessed from the cloud provider. You have the option to either <a href="https://docs.zenml.io/getting-started/deploying-zenml" id="">self-host a ZenML server</a> or <a href="https://cloud.zenml.io/signup" id="">register for a free ZenML Pro account</a>.</li></ul>

## üèó Resources Created

The Terraform module in this repository creates the following resources in your AWS account:

<div data-rt-embed-type="true"><div class="table-container">
 &nbsp;
 &nbsp; &nbsp; 
 &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; 
 &nbsp; &nbsp; 
 &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; 
 &nbsp;<table cellspacing="0"><thead><tr><th style="text-align: left; font-size: 1rem;"></th><th style="text-align: left; font-size: 1rem;">AWS</th><th style="text-align: left; font-size: 1rem;">GCP</th><th style="text-align: left; font-size: 1rem;">Azure</th></tr></thead><tbody><tr><td style="font-weight: bold; font-size: 1rem;">Resources provisioned</td><td>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<ol>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <li>an <a href="https://aws.amazon.com/s3/">S3 bucket</a></li>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <li>an <a href="https://docs.aws.amazon.com/AmazonECR/latest/userguide/Repositories.html">ECR repository</a></li>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <li>an <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_users.html">IAM user</a> and an access key for it</li>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <li>an <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html">IAM role</a> with the minimum necessary permissions to access the S3 bucket, the ECR repository and the SageMaker service to build and push container images, store artifacts, and run pipelines</li>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</ol>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </td><td>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<ol>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <li>a <a href="https://cloud.google.com/storage/docs/creating-buckets">GCS bucket</a></li>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <li>a <a href="https://cloud.google.com/artifact-registry">Google Artifact Registry</a></li>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <li>a <a href="https://cloud.google.com/iam/docs/service-account-overview">Service Account</a> with a Service Account Key and the minimum necessary permissions to access the GCS bucket, the Google Artifact Registry and the GCP project to build and push container images with Google Cloud Build, store artifacts and run pipelines with Vertex AI.</li>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</ol>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </td><td>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<ol>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <li>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;an <a href="https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/manage-resource-groups-portal">Azure Resource Group</a> with the following child resources:
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<ol type="a">
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <li>an <a href="https://learn.microsoft.com/en-us/azure/storage/common/storage-account-overview">Azure Storage Account</a> and a <a href="https://learn.microsoft.com/en-us/azure/storage/blobs/storage-blobs-introduction">Blob Container</a></li>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <li>an <a href="https://azure.microsoft.com/en-us/products/container-registry">Azure Container Registry</a></li>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</ol>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </li>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <li>an <a href="https://learn.microsoft.com/en-us/entra/identity-platform/app-objects-and-service-principals">Azure Service Principal</a> with a Service Principal Password and the minimum necessary permissions to access the Blob Container, the ACR container registry and the Azure subscription to build and push container images, store artifacts and run pipelines with Skypilot.</li>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</ol>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </td></tr><tr><td style="font-weight: bold; font-size: 1rem;">Stack components created</td><td>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<ol>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <li>an <a href="https://docs.zenml.io/stack-components/artifact-stores/s3">S3 Artifact Store</a> linked to the S3 bucket</li>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <li>an <a href="https://docs.zenml.io/stack-components/container-registries/aws">ECR Container Registry</a> linked to the ECR repository</li>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <li>a <a href="https://docs.zenml.io/stack-components/orchestrators/sagemaker">SageMaker Orchestrator</a> linked to the AWS account</li>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <li>an <a href="https://docs.zenml.io/how-to/auth-management/aws-service-connector">AWS Service Connector</a> configured with the IAM role credentials and used to authenticate all ZenML components with the AWS account</li>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</ol>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </td><td>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<ol>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <li>an <a href="https://docs.zenml.io/stack-components/artifact-stores/gcp">GCP Artifact Store</a> linked to the GCS bucket</li>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <li>an <a href="https://docs.zenml.io/stack-components/container-registries/gcp">GCP Container Registry</a> linked to the Google Artifact Registry</li>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <li>a <a href="https://docs.zenml.io/stack-components/orchestrators/vertex">Vertex AI Orchestrator</a> linked to the GCP project</li>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <li>a <a href="https://docs.zenml.io/stack-components/image-builders/gcp">Google Cloud Build Image Builder</a> linked to the GCP project</li>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <li>a <a href="https://docs.zenml.io/how-to/auth-management/gcp-service-connector">GCP Service Connector</a> configured with the GCP service account credentials and used to authenticate all ZenML components with the GCP resources</li>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</ol>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </td><td>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<ol>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <li>an <a href="https://docs.zenml.io/stack-components/artifact-stores/azure">Azure Artifact Store</a> linked to the Azure Storage Account and Blob Container</li>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <li>an <a href="https://docs.zenml.io/stack-components/container-registries/azure">ACR Container Registry</a> linked to the Azure Container Registry</li>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <li>an <a href="https://docs.zenml.io/stack-components/orchestrators/skypilot-vm">Azure Skypilot Orchestrator</a> linked to the Azure subscription</li>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <li>an <a href="https://docs.zenml.io/how-to/auth-management/azure-service-connector">Azure Service Connector</a> configured with the Azure Service Principal credentials and used to authenticate all ZenML components with the Azure resources</li>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</ol>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </td></tr></tbody></table>
</div></div>

## üöÄ How to use the Terraform modules

Aside from the prerequisites mentioned above, you also need to create [a ZenML Service Account API key](https://docs.zenml.io/how-to/connecting-to-zenml/connect-with-a-service-account) for your ZenML Server. You can do this by running the following command in a terminal where you have the ZenML CLI installed:

<div data-rt-embed-type="true"><pre><code>zenml service-account create &lt;service-account-name&gt;</code></pre></div>

After that, it‚Äôs a matter of copying this code snippet into a file. Here is an example configuration for AWS (GCP and Azure are similar):

<div data-rt-embed-type="true"><pre><code>module "zenml_stack" {
 &nbsp;source &nbsp;= "zenml-io/zenml-stack/aws"
 &nbsp;region = "us-west-2"
 &nbsp;zenml_server_url = "https://your-zenml-server-url.com"
 &nbsp;zenml_api_key = "ZENKEY_1234567890..."
}</code></pre></div>

You can then execute:

<div data-rt-embed-type="true"><pre><code>terraform init
terraform apply</code></pre></div>

If you would like to destroy the resources and delete the stack, you can run:

<div data-rt-embed-type="true"><pre><code>terraform destroy</code></pre></div>

Wait a few minutes, and you will see a fully configured stack in your ZenML dashboard!

> üì¢ Note that currently the terraform scripts only deploy a basic cloud stack with an orchestrator, container registry, image builder, and artifact store. To add more components, please read the docs

# üí® Try it yourself

You can try it yourself by following the instructions above or following the guide in the Hashicorp registry for [AWS](https://registry.terraform.io/modules/zenml-io/zenml-stack/aws/latest) ([Source](https://github.com/zenml-io/terraform-aws-zenml-stack)), [GCP](https://registry.terraform.io/modules/zenml-io/zenml-stack/gcp/latest) ([Source](https://github.com/zenml-io/terraform-gcp-zenml-stack)), or [Azure](https://registry.terraform.io/modules/zenml-io/zenml-stack/azure/latest) ([Source](https://registry.terraform.io/modules/zenml-io/zenml-stack/azure/latest)). The corresponding open-source GitHub repositories are also available.

If you need assistance, join our [Slack Community](https://zenml.io/slack) and drop a message in the `#general` channel. We‚Äôre known for our quick and helpful responses!

## ‚≠êÔ∏è Show Your Support

If you find this project helpful, please consider giving ZenML a star on GitHub. Your support helps promote the project and lets others know it's worth checking out.

Thank you for your support! üåü

<div data-rt-embed-type="true"><a class="github-button" href="https://github.com/zenml-io/zenml" data-color-scheme="no-preference: light; light: light; dark: light;" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star zenml-io/zenml on GitHub">Star</a></div>