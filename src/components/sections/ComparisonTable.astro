---
/**
 * ComparisonTable — semantic HTML table for feature comparisons.
 *
 * Renders a responsive, accessible <table> with alternating row backgrounds.
 * Supports optional row icons and per-column header colors.
 * Used on /open-source-vs-pro.
 */
import type { ComparisonTableData } from "../../lib/marketingPageTypes";

interface Props extends ComparisonTableData {}

const { eyebrow, headline, subheadline, columnHeaders, headerColors, rows } = Astro.props;
const hasIcons = rows.some((r) => r.icon);
---

<section class="bg-white py-16 sm:py-20">
  <div class="mx-auto max-w-5xl px-4 sm:px-6 lg:px-8">
    {/* Header */}
    <div class="mb-10 text-center">
      {eyebrow && (
        <p class="text-sm font-semibold uppercase tracking-wider text-zenml-500">
          {eyebrow}
        </p>
      )}
      <h2 class="mt-2 text-2xl font-bold text-gray-900 sm:text-3xl">
        {headline}
      </h2>
      {subheadline && (
        <p class="mt-2 text-lg text-gray-600">{subheadline}</p>
      )}
    </div>

    {/* Table wrapper — horizontal scroll on mobile */}
    <div class="-mx-4 overflow-x-auto px-4 sm:mx-0 sm:px-0">
      <table class="w-full min-w-[600px] border-collapse text-left">
        <thead>
          <tr class="border-b-2 border-gray-200">
            <th class="py-3 pr-4 pl-6 text-sm font-semibold text-purple-700">Feature</th>
            {columnHeaders.map((header, idx) => (
              <th class:list={[
                "py-3 px-4 text-center text-sm font-bold",
                headerColors?.[idx] ?? "text-gray-900",
              ]}>
                {header}
              </th>
            ))}
          </tr>
        </thead>
        <tbody>
          {rows.map((row, i) => (
            <tr class:list={[
              "border-b border-gray-100",
              i % 2 === 0 ? "bg-gray-50" : "bg-white",
            ]}>
              <td class="py-4 pr-4">
                <div class:list={["flex items-center gap-4", hasIcons && "pl-2"]}>
                  {row.icon && (
                    <div class="comparison-icon flex-shrink-0" set:html={row.icon} />
                  )}
                  <div>
                    <div class="font-semibold text-gray-900">{row.feature}</div>
                    {row.description && (
                      <div class="mt-0.5 text-xs text-gray-500">{row.description}</div>
                    )}
                  </div>
                </div>
              </td>
              {row.columns.map((value) => (
                <td class="px-4 py-4 text-center text-sm text-gray-600">
                  {value}
                </td>
              ))}
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  </div>
</section>

<style>
  .comparison-icon {
    border: 0.5rem solid var(--color-purple-50, #f9f5ff);
    background-color: var(--color-purple-100, #f4ebff);
    color: var(--color-purple-600, #7f56d9);
    border-radius: 100%;
    width: 3.5rem;
    height: 3.5rem;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .comparison-icon :global(svg) {
    width: 1.5rem;
    height: 1.5rem;
    color: inherit;
  }
</style>
