---
/**
 * StorylaneEmbed — responsive iframe wrapper for Storylane interactive demos.
 *
 * Replicates the Webflow embed structure: a container with padding-bottom
 * aspect ratio trick, and an absolutely-positioned iframe inside it.
 */
interface Props {
  /** Storylane demo URL (e.g., https://app.storylane.io/demo/xxx) */
  src: string;
  /** Accessible iframe title */
  title: string;
}

const { src, title } = Astro.props;
---

<div class="sl-embed" style="position:relative;padding-bottom:calc(65.94% + 27px);width:100%;height:0;transform:scale(1)">
  <iframe
    class="sl-demo"
    src={src}
    title={title}
    name="sl-embed"
    allow="fullscreen; camera; microphone"
    style="position:absolute;top:0;left:0;width:100%;height:100%;border:1px solid rgba(63,95,172,0.35);box-shadow:0px 0px 18px rgba(26,19,72,0.15);border-radius:10px;box-sizing:border-box;"
  ></iframe>
</div>
{/* Storylane enhancement script — gated behind marketing consent + prod hostname */}
<script is:inline>
  (function() {
    var hosts = ['www.zenml.io','zenml.io'];
    if (hosts.indexOf(window.location.hostname) === -1) return;
    try {
      var c = JSON.parse(localStorage.getItem('cookie_consent') || '{}');
      if (!c.marketing) return;
    } catch(e) { return; }
    if (document.getElementById('cc-storylane')) return;
    var s = document.createElement('script');
    s.id = 'cc-storylane';
    s.src = 'https://js.storylane.io/js/v1/storylane.js';
    document.head.appendChild(s);
  })();
</script>
