---
/**
 * TagCloud â€” footer tag cloud with expandable overflow.
 *
 * Shows top N tags as pills, with a <details> expand for the rest.
 * Links to existing /tags/{slug} routes.
 */
import type { TaxonomyCount } from "../../lib/blog";

interface Props {
  tags: TaxonomyCount[];
  activeTag?: string;
  /** Number of tags to show before "show all" */
  limit?: number;
}

const { tags, activeTag, limit = 20 } = Astro.props;

const visibleTags = tags.slice(0, limit);
const hiddenTags = tags.slice(limit);
---

{tags.length > 0 && (
  <section class="border-t border-gray-200 bg-gray-50">
    <div class="mx-auto max-w-[1440px] px-4 py-12 sm:px-6 lg:px-8">
      <h2 class="mb-5 text-xs font-semibold uppercase tracking-wider text-gray-400">
        Popular Topics
      </h2>
      <div class="flex flex-wrap gap-2">
        {visibleTags.map((tag) => (
          <a
            href={`/tags/${tag.slug}`}
            class:list={[
              "inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium transition-colors",
              activeTag === tag.slug
                ? "bg-gray-900 text-white"
                : "bg-gray-100 text-gray-700 hover:bg-gray-200",
            ]}
          >
            {tag.name}
          </a>
        ))}
      </div>
      {hiddenTags.length > 0 && (
        <details class="mt-4">
          <summary class="cursor-pointer text-sm font-medium text-gray-500 hover:text-gray-700">
            +{hiddenTags.length} more topics
          </summary>
          <div class="mt-3 flex flex-wrap gap-2">
            {hiddenTags.map((tag) => (
              <a
                href={`/tags/${tag.slug}`}
                class:list={[
                  "inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium transition-colors",
                  activeTag === tag.slug
                    ? "bg-gray-900 text-white"
                    : "bg-gray-100 text-gray-700 hover:bg-gray-200",
                ]}
              >
                {tag.name}
              </a>
            ))}
          </div>
        </details>
      )}
    </div>
  </section>
)}
