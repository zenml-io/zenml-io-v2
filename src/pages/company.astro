---
/**
 * Company page.
 *
 * Route: /company
 *
 * About ZenML: hero, team photo + about text, company values (5),
 * team member grid (CMS), and open positions.
 */
import BaseLayout from "../layouts/BaseLayout.astro";
import Button from "../components/Button.astro";
import { getCollection } from "astro:content";
import {
  COMPANY_SEO,
  COMPANY_HERO,
  COMPANY_ABOUT,
  COMPANY_VALUES,
  OPEN_POSITIONS,
} from "../lib/company";

// Pull team members from CMS collection, sorted by order
const allTeam = await getCollection("team");
const teamMembers = allTeam
  .filter((m) => !(m.data as any).draft)
  .sort((a, b) => ((a.data as any).order ?? 99) - ((b.data as any).order ?? 99));
---

<BaseLayout
  title={COMPANY_SEO.title}
  description={COMPANY_SEO.description}
  ogTitle={COMPANY_SEO.ogTitle}
  ogDescription={COMPANY_SEO.ogDescription}
  ogImage={COMPANY_SEO.ogImage}
>
  <main>
    {/* Hero */}
    <section class="bg-white pt-16 pb-12 sm:pt-24 sm:pb-16">
      <div class="mx-auto max-w-4xl px-4 text-center sm:px-6 lg:px-8">
        <p class="text-sm font-semibold uppercase tracking-wider text-zenml-500">
          {COMPANY_HERO.eyebrow}
        </p>
        <h1 class="mt-2 text-3xl font-bold text-gray-900 sm:text-4xl lg:text-5xl">
          {COMPANY_HERO.headline}
        </h1>
        <p class="mt-4 text-lg text-gray-600">{COMPANY_HERO.deck}</p>
      </div>
    </section>

    {/* About section â€” photo + text side-by-side */}
    <section class="bg-white py-12 sm:py-16">
      <div class="mx-auto max-w-4xl px-4 sm:px-6 lg:px-8">
        <div class="grid items-center gap-10 lg:grid-cols-2">
          <img
            src={COMPANY_ABOUT.image.url}
            alt={COMPANY_ABOUT.image.alt}
            class="w-full rounded-xl"
            loading="lazy"
          />
          <div>
            <h2 class="text-2xl font-bold text-gray-900 sm:text-3xl">
              {COMPANY_ABOUT.headline}
            </h2>
            <p class="mt-4 text-gray-600 leading-relaxed">
              {COMPANY_ABOUT.body}
            </p>
          </div>
        </div>
      </div>
    </section>

    {/* Values */}
    <section class="bg-gray-50 py-16 sm:py-20">
      <div class="mx-auto max-w-6xl px-4 sm:px-6 lg:px-8">
        <div class="grid gap-8 sm:grid-cols-2 lg:grid-cols-3">
          {COMPANY_VALUES.map((value) => (
            <div class="rounded-xl bg-white p-6 shadow-sm">
              <h3 class="text-lg font-bold text-gray-900">{value.title}</h3>
              <p class="mt-1 text-sm text-zenml-500">{value.subtitle}</p>
              <ul class="mt-4 space-y-2">
                {value.bullets.map((bullet) => (
                  <li class="flex items-start gap-2 text-sm text-gray-600">
                    <svg class="mt-0.5 h-4 w-4 flex-shrink-0 text-zenml-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 1 1-18 0 9 9 0 0 1 18 0z" />
                    </svg>
                    {bullet}
                  </li>
                ))}
              </ul>
            </div>
          ))}
        </div>
      </div>
    </section>

    {/* Team grid */}
    <section id="team" class="bg-white py-16 sm:py-20">
      <div class="mx-auto max-w-6xl px-4 sm:px-6 lg:px-8">
        <h2 class="text-2xl font-bold text-gray-900 sm:text-3xl">Meet the team</h2>
        <div class="mt-10 grid gap-8 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4">
          {teamMembers.map((member) => {
            const d = member.data as any;
            return (
              <div class="text-center">
                {d.photo?.url ? (
                  <img
                    src={d.photo.url}
                    alt={d.title}
                    class="mx-auto h-32 w-32 rounded-full object-cover"
                    loading="lazy"
                  />
                ) : (
                  <div class="mx-auto flex h-32 w-32 items-center justify-center rounded-full bg-gray-100 text-2xl font-bold text-gray-400">
                    {d.title?.charAt(0) ?? "?"}
                  </div>
                )}
                <h3 class="mt-3 font-semibold text-gray-900">{d.title}</h3>
                {d.position && (
                  <p class="mt-1 text-sm text-zenml-500">{d.position}</p>
                )}
                {d.linkedin && (
                  <a
                    href={d.linkedin}
                    target="_blank"
                    rel="noopener noreferrer"
                    class="mt-2 inline-block text-sm text-gray-400 hover:text-gray-600"
                    aria-label={`${d.title} on LinkedIn`}
                  >
                    <svg class="h-5 w-5" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M22.2234 0H1.77187C0.792187 0 0 0.773438 0 1.72969V22.2656C0 23.2219 0.792187 24 1.77187 24H22.2234C23.2031 24 24 23.2219 24 22.2703V1.72969C24 0.773438 23.2031 0 22.2234 0ZM7.12031 20.4516H3.55781V8.99531H7.12031V20.4516ZM5.33906 7.43438C4.19531 7.43438 3.27188 6.51094 3.27188 5.37187C3.27188 4.23281 4.19531 3.30937 5.33906 3.30937C6.47813 3.30937 7.40156 4.23281 7.40156 5.37187C7.40156 6.50625 6.47813 7.43438 5.33906 7.43438ZM20.4516 20.4516H16.8937V14.8828C16.8937 13.5562 16.8703 11.8453 15.0422 11.8453C13.1906 11.8453 12.9094 13.2937 12.9094 14.7891V20.4516H9.35625V8.99531H12.7687V10.5609H12.8156C13.2891 9.66094 14.4516 8.70938 16.1813 8.70938C19.7859 8.70938 20.4516 11.0813 20.4516 14.1656V20.4516Z" />
                    </svg>
                  </a>
                )}
              </div>
            );
          })}
        </div>
      </div>
    </section>

    {/* Open Positions */}
    <section class="bg-gray-50 py-16 sm:py-20">
      <div id="open-positions" class="mx-auto max-w-3xl px-4 sm:px-6 lg:px-8">
        <h2 class="text-center text-2xl font-bold text-gray-900 sm:text-3xl">Open Positions</h2>
        <div class="mt-8 space-y-3">
          {OPEN_POSITIONS.map((position) => (
            <a
              href={position.href}
              target="_blank"
              rel="noopener noreferrer"
              class="flex items-center justify-between rounded-lg border border-gray-200 bg-white px-6 py-4 transition hover:shadow-md"
            >
              <span class="text-gray-900">
                {position.title} - <strong>{position.type}</strong>
              </span>
              <svg class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" />
              </svg>
            </a>
          ))}
        </div>
      </div>
    </section>
  </main>
</BaseLayout>
