---
/**
 * Deployments page.
 *
 * Route: /deployments
 *
 * Deployment options overview: hero, architecture diagram + feature cards,
 * OSS vs Pro comparison table, 3 deployment scenario layouts, deployment
 * methods grid, tabbed architecture diagrams, and final CTA.
 */
import BaseLayout from "../layouts/BaseLayout.astro";
import Button from "../components/Button.astro";
import {
  DEPLOYMENTS_SEO,
  DEPLOYMENTS_HERO,
  DEPLOYMENTS_ARCHITECTURE,
  DEPLOYMENTS_COMPARISON,
  DEPLOYMENTS_SCENARIOS,
  DEPLOYMENTS_METHODS,
  DEPLOYMENTS_TABS,
  DEPLOYMENTS_FINAL_CTA,
} from "../lib/deployments";
---

<BaseLayout
  title={DEPLOYMENTS_SEO.title}
  description={DEPLOYMENTS_SEO.description}
  ogTitle={DEPLOYMENTS_SEO.ogTitle}
  ogDescription={DEPLOYMENTS_SEO.ogDescription}
  ogImage={DEPLOYMENTS_SEO.ogImage}
>
  <main>
    {/* Hero */}
    <section class="bg-white pt-16 pb-12 sm:pt-24 sm:pb-16">
      <div class="mx-auto max-w-4xl px-4 text-center sm:px-6 lg:px-8">
        <h1 class="text-3xl font-bold text-gray-900 sm:text-4xl lg:text-5xl">
          {DEPLOYMENTS_HERO.headline}
        </h1>
        <p class="mt-4 text-lg text-gray-600 leading-relaxed">
          {DEPLOYMENTS_HERO.deck}
        </p>
        <div class="mt-8 flex flex-col items-center gap-3 sm:flex-row sm:justify-center">
          <Button href={DEPLOYMENTS_HERO.primaryCta.href} variant="secondary" size="lg">
            {DEPLOYMENTS_HERO.primaryCta.label}
          </Button>
          <Button
            href={DEPLOYMENTS_HERO.secondaryCta.href}
            size="lg"
            target="_blank"
            rel="noopener noreferrer"
          >
            {DEPLOYMENTS_HERO.secondaryCta.label}
          </Button>
        </div>
      </div>
    </section>

    {/* Architecture overview (dark) */}
    <section class="bg-gray-900 py-16 sm:py-20">
      <div class="mx-auto max-w-5xl px-4 sm:px-6 lg:px-8">
        <div class="max-w-3xl">
          <p class="text-sm font-semibold uppercase tracking-wider text-zenml-400">
            {DEPLOYMENTS_ARCHITECTURE.eyebrow}
          </p>
          <h2 class="mt-2 text-2xl font-bold text-white sm:text-3xl">
            {DEPLOYMENTS_ARCHITECTURE.headline}
          </h2>
          <p class="mt-3 text-lg text-gray-300">
            {DEPLOYMENTS_ARCHITECTURE.body}
          </p>
        </div>
        <div class="mt-8">
          <img
            src={DEPLOYMENTS_ARCHITECTURE.image.url}
            alt={DEPLOYMENTS_ARCHITECTURE.image.alt}
            class="w-full max-w-[900px]"
            loading="lazy"
          />
        </div>
        <div class="mt-10 grid gap-6 sm:grid-cols-3">
          {DEPLOYMENTS_ARCHITECTURE.features.map((feat) => (
            <div>
              <p class="text-sm font-semibold uppercase tracking-wider text-orange-400">
                {feat.eyebrow}
              </p>
              <h3 class="mt-2 text-lg font-semibold text-white">{feat.title}</h3>
              <p class="mt-2 text-sm text-gray-300">{feat.body}</p>
            </div>
          ))}
        </div>
      </div>
    </section>

    {/* Comparison table (dark) */}
    <section class="bg-gray-900 pb-16 sm:pb-20">
      <div class="mx-auto max-w-4xl px-4 sm:px-6 lg:px-8">
        <div class="max-w-3xl">
          <p class="text-sm font-semibold uppercase tracking-wider text-zenml-400">
            {DEPLOYMENTS_COMPARISON.eyebrow}
          </p>
          <h2 class="mt-2 text-2xl font-bold text-white sm:text-3xl">
            {DEPLOYMENTS_COMPARISON.headline}
          </h2>
        </div>
        <div class="mt-8 overflow-x-auto">
          <table class="w-full min-w-[500px] border-collapse text-sm">
            <thead>
              <tr class="border-b border-gray-700">
                <th class="py-3 pr-4 text-left font-medium text-gray-400">Feature</th>
                {DEPLOYMENTS_COMPARISON.columnHeaders.map((header) => (
                  <th class="px-4 py-3 text-center font-bold text-white">{header}</th>
                ))}
              </tr>
            </thead>
            <tbody>
              {DEPLOYMENTS_COMPARISON.rows.map((row, i) => (
                <tr class:list={[
                  "border-b border-gray-800",
                  i % 2 === 0 ? "bg-gray-800/30" : "",
                ]}>
                  <td class="py-3 pr-4 font-medium text-white">{row.feature}</td>
                  {row.values.map((val) => (
                    <td class="px-4 py-3 text-center">
                      {val === true ? (
                        <svg class="mx-auto h-5 w-5 text-zenml-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M7.5 12l3 3 6-6m5.5 3a10 10 0 1 1-20 0 10 10 0 0 1 20 0z" />
                        </svg>
                      ) : val === false ? (
                        <svg class="mx-auto h-5 w-5 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h14" />
                        </svg>
                      ) : (
                        <span class="text-gray-300">{val}</span>
                      )}
                    </td>
                  ))}
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      </div>
    </section>

    {/* Deployment scenarios (alternating layouts) */}
    <section class="bg-white py-16 sm:py-20">
      <div class="mx-auto max-w-6xl px-4 sm:px-6 lg:px-8 space-y-16">
        {DEPLOYMENTS_SCENARIOS.map((scenario, i) => (
          <div class:list={[
            "grid items-center gap-10 lg:grid-cols-2",
            i % 2 === 1 && "lg:[direction:rtl] lg:[&>*]:[direction:ltr]",
          ]}>
            <div>
              <h2 class="text-2xl font-bold text-gray-900 sm:text-3xl">
                {scenario.title}
              </h2>
              <ul class="mt-4 space-y-2">
                {scenario.bullets.map((bullet) => (
                  <li class="flex items-start gap-2 text-gray-600">
                    <svg class="mt-0.5 h-5 w-5 flex-shrink-0 text-zenml-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4" />
                    </svg>
                    {bullet}
                  </li>
                ))}
              </ul>
              <a
                href={scenario.learnMoreHref}
                target={scenario.learnMoreHref.startsWith("http") ? "_blank" : undefined}
                rel={scenario.learnMoreHref.startsWith("http") ? "noopener noreferrer" : undefined}
                class="mt-4 inline-flex items-center gap-1 text-sm font-semibold text-zenml-500 hover:text-zenml-600"
              >
                Learn More
                <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M13 7l5 5-5 5M6 12h12" />
                </svg>
              </a>
            </div>
            <img
              src={scenario.image.url}
              alt={scenario.image.alt}
              class="w-full rounded-xl"
              loading="lazy"
            />
          </div>
        ))}
      </div>
    </section>

    {/* Deployment methods grid */}
    <section class="bg-gray-50 py-12">
      <div class="mx-auto max-w-5xl px-4 sm:px-6 lg:px-8">
        <p class="text-gray-600">Various methods available:</p>
        <div class="mt-4 grid gap-4 sm:grid-cols-2 lg:grid-cols-4">
          {DEPLOYMENTS_METHODS.map((method) => (
            <a
              href={method.href}
              target="_blank"
              rel="noopener noreferrer"
              class="flex items-center gap-4 rounded-xl border border-gray-200 bg-white p-4 transition hover:shadow-md"
            >
              <img
                src={method.icon}
                alt={method.iconAlt}
                class="h-12 w-12 flex-shrink-0 object-contain"
                loading="lazy"
              />
              <div>
                <h3 class="font-semibold text-gray-900">{method.title}</h3>
                <p class="mt-1 text-xs text-gray-500">{method.body}</p>
              </div>
            </a>
          ))}
        </div>
      </div>
    </section>

    {/* Tabbed architecture diagrams */}
    <section class="bg-white py-16 sm:py-20">
      <div class="mx-auto max-w-5xl px-4 text-center sm:px-6 lg:px-8">
        <p class="text-sm font-semibold uppercase tracking-wider text-zenml-500">
          {DEPLOYMENTS_TABS.eyebrow}
        </p>
        <h2 class="mt-2 text-2xl font-bold text-gray-900 sm:text-3xl">
          {DEPLOYMENTS_TABS.headline}
        </h2>
        <p class="mt-3 text-lg text-gray-600">{DEPLOYMENTS_TABS.body}</p>

        {/* Tab switcher */}
        <div class="mt-10">
          <div class="inline-flex rounded-lg border border-gray-200 bg-gray-100 p-1" role="tablist">
            {DEPLOYMENTS_TABS.tabs.map((tab, i) => (
              <button
                type="button"
                role="tab"
                aria-selected={i === 0 ? "true" : "false"}
                aria-controls={`deploy-panel-${i}`}
                data-deploy-tab-index={i}
                class:list={[
                  "deploy-tab-btn flex items-center gap-2 rounded-md px-4 py-2 text-sm font-semibold transition-all",
                  i === 0
                    ? "bg-white text-gray-900 shadow-sm"
                    : "text-gray-500 hover:text-gray-700",
                ]}
              >
                {tab.label}
                <span class:list={[
                  "rounded-full px-2 py-0.5 text-xs font-bold",
                  tab.badgeVariant === "pro"
                    ? "bg-orange-100 text-orange-600"
                    : "bg-zenml-50 text-zenml-500",
                ]}>
                  {tab.badge}
                </span>
              </button>
            ))}
          </div>
        </div>

        {/* Tab panels */}
        {DEPLOYMENTS_TABS.tabs.map((tab, i) => (
          <div
            id={`deploy-panel-${i}`}
            role="tabpanel"
            class:list={["mt-6", i !== 0 && "hidden"]}
          >
            <p class="mx-auto max-w-2xl text-sm text-gray-600">{tab.description}</p>
            <img
              src={tab.image.url}
              alt={tab.image.alt}
              class="mx-auto mt-6 max-w-[680px] w-full"
              loading="lazy"
            />
          </div>
        ))}

        {/* Feature grid */}
        <div class="mt-12 grid gap-6 text-left sm:grid-cols-2 lg:grid-cols-3">
          {DEPLOYMENTS_TABS.features.map((feat) => (
            <div>
              <h3 class="font-semibold text-gray-900">{feat.title}</h3>
              <p class="mt-1 text-sm text-gray-600">{feat.body}</p>
            </div>
          ))}
        </div>
      </div>
    </section>

    {/* Final CTA (dark) */}
    <section class="bg-gray-900 py-16 sm:py-20">
      <div class="mx-auto max-w-6xl px-4 sm:px-6 lg:px-8">
        <div class="grid items-center gap-10 lg:grid-cols-2">
          <div>
            <h2 class="text-2xl font-bold text-white sm:text-3xl">
              {DEPLOYMENTS_FINAL_CTA.headline}
            </h2>
            <ul class="mt-6 space-y-3">
              {DEPLOYMENTS_FINAL_CTA.bullets.map((bullet) => (
                <li class="flex items-center gap-3 text-lg text-white">
                  <svg class="h-6 w-6 flex-shrink-0 text-zenml-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 1 1-18 0 9 9 0 0 1 18 0z" />
                  </svg>
                  {bullet}
                </li>
              ))}
            </ul>
            <div class="mt-8 flex flex-wrap gap-3">
              <Button href={DEPLOYMENTS_FINAL_CTA.primaryCta.href} variant="secondary" size="lg">
                {DEPLOYMENTS_FINAL_CTA.primaryCta.label}
              </Button>
              <Button href={DEPLOYMENTS_FINAL_CTA.secondaryCta.href} size="lg">
                {DEPLOYMENTS_FINAL_CTA.secondaryCta.label}
              </Button>
            </div>
          </div>
          <img
            src={DEPLOYMENTS_FINAL_CTA.image.url}
            alt={DEPLOYMENTS_FINAL_CTA.image.alt}
            class="w-full rounded-xl shadow-2xl"
            loading="lazy"
          />
        </div>
      </div>
    </section>
  </main>
</BaseLayout>

{/* Tab switching script */}
<script>
  const buttons = document.querySelectorAll<HTMLButtonElement>(".deploy-tab-btn");
  buttons.forEach((btn) => {
    btn.addEventListener("click", () => {
      const idx = btn.dataset.deployTabIndex;
      buttons.forEach((b, i) => {
        const isActive = String(i) === idx;
        b.setAttribute("aria-selected", String(isActive));
        b.classList.toggle("bg-white", isActive);
        b.classList.toggle("text-gray-900", isActive);
        b.classList.toggle("shadow-sm", isActive);
        b.classList.toggle("text-gray-500", !isActive);
      });
      document.querySelectorAll<HTMLDivElement>("[id^='deploy-panel-']").forEach((panel, i) => {
        panel.classList.toggle("hidden", String(i) !== idx);
      });
    });
  });
</script>
